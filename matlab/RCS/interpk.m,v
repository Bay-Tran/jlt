head	1.3;
access;
symbols;
locks; strict;
comment	@// @;


1.3
date	2006.02.25.15.34.06;	author jeanluc;	state Exp;
branches;
next	1.2;

1.2
date	2005.12.03.12.54.02;	author jeanluc;	state Exp;
branches;
next	1.1;

1.1
date	2005.12.03.08.31.43;	author jeanluc;	state Exp;
branches;
next	;


desc
@Interpolate given a Fourier representation.
@


1.3
log
@Change convention to 'meshgrid' style, so rows are Y and cols X.
@
text
@function fx = interpk(fk,x,L)
%INTERPK   Interpolate given a Fourier representation.
%   FX = INTERPK(FK,X) returns F(X) given the Fourier representation
%   FK of the real periodic function F.
%
%   FX = INTERPK(FK,[X Y]) returns F(X,Y) given the 2D Fourier
%   representation FK of the 2D-periodic real function F.  The array
%   FK is assumed to be in 'meshgrid' style, where the rows are Y and
%   the columns X.
%
%   FX = INTERPK(FK,X,L) specifies the domain size L, which
%   defaults to 1.
%
%   FX = INTERPK(FK,[X Y],[LX LY]) specifies the domain sizes LX and
%   LY, which default to 1 and 1.  FX = INTERPK(FK,[X Y],L)
%   specifies LX = LY = L.
%
%   See also FFT, FFT2.

% $Id: interpk.m,v 1.2 2005/12/03 12:54:02 jeanluc Exp $

% TODO: use real symmetry to cut down execution time.

N = size(fk,1);
kmin = floor(-(N-1)/2);
kmax = floor( (N-1)/2);
k = [0:kmax kmin:-1];
nd = ndims(fk);

if nargin < 3
  if nd == 1
    L = 1;
  elseif nd == 2
    L(1) = 1;
    L(2) = 1;
  else
    error('Too many dimensions.')
  end
elseif nargin == 3
  if nd == 2 & max(size(L)) == 1
    % If only a number is given in 2D, make the periodicities the same.
    L(2) = L(1);
  end
end

if nd == 2 & (size(fk,1) == 1 | size(fk,2) == 1)
  % NDIMS returns at least two, unfortunately, so adjust nd.
  nd = 1;
  ex = exp(2*pi*i/L * k' * x(1));
elseif ndims(fk) == 2
  % Note that the array fk is assumed to be in 'meshgrid' style,
  % where the rows are Y and the columns X.
  ex = exp(2*pi*i/L(2) * k' * x(2))*exp(2*pi*i/L(1) * k * x(1));
else
  error('Too many dimensions.')
end

% Now its just pointwise multiplication of the two arrays, which
% can be done in the same way in any dimensions.
fx = real(fk(:).'*ex(:))/N^nd;
@


1.2
log
@Allow the specification of only one periodicity even in 2D.
@
text
@d6 4
a9 2
%   FX = INTERPK(FK,[X1 X2]) returns F(X1,X2) given the 2D Fourier
%   representation FK of the 2D-periodic real function F.
d14 3
a16 3
%   FX = INTERPK(FK,[X1 X2],[L1 L2]) specifies the domain sizes L1 and
%   L2, which default to 1 and 1.  FX = INTERPK(FK,[X1 X2],L)
%   specifies L1 = L2 = L.
d20 1
a20 1
% $Id: interpk.m,v 1.1 2005/12/03 08:31:43 jeanluc Exp $
d27 1
a27 1
k = [0 1:kmax kmin:-1];
d51 3
a53 1
  ex = exp(2*pi*i/L(1) * k' * x(1))*exp(2*pi*i/L(2) * k * x(2));
@


1.1
log
@Initial revision
@
text
@d12 3
a14 2
%   FX = INTERPK(FK,[X1 X2],[L1 L2]) specifies the domain sizes L1
%   and L2, which default to 1 and 1.
d18 1
a18 1
% $Id$
d37 5
@
