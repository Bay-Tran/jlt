head	1.2;
access;
symbols;
locks; strict;
comment	@// @;


1.2
date	2008.03.02.19.52.30;	author jeanluc;	state Exp;
branches;
next	1.1;

1.1
date	2006.03.05.11.21.32;	author jeanluc;	state Exp;
branches;
next	;


desc
@Smooth data by filtering Fourier spectrum.
@


1.2
log
@Renormalise so that max is at same level.
@
text
@function fs = smoothk(f,cutoff,pfilt)
%SMOOTHK   Smooth data by filtering Fourier spectrum.
%   FS = SMOOTH(F,CUTOFF,PFILT) returns smoothed FS given a
%   function F.  CUTOFF (default 10) is the cutoff wavenumber, and
%   PFILT is the 'power' (flatness) of the filter (default 2).
%
%   See also SMOOTH3.

% $Id: smoothk.m,v 1.1 2006/03/05 11:21:32 jeanluc Exp $

if nargin < 3
  % Power (flatness) of filter
  pfilt = 2;
end

if nargin < 2
  % Cutoff wavenumber
  cutoff = 10;
end

% Apply filter to every dimension.  Not tested for numDims>2.

numDims = ndims(f);

fs = f;
sz = size(f);

for d = 1:numDims
  N = sz(d);
  kmin = floor(-(N-1)/2);
  kmax = floor( (N-1)/2);
  k = [0:kmax kmin:-1];
  %
  % Smooth
  %
  fk = fft(fs,[],d);
  % The filter
  filtk = exp(-(abs(k).^pfilt)/cutoff^pfilt);
  % Complicated rigmarole to replicate the filter along dimension d.
  % The problem is the singleton dimension of filtk.  I think
  % reshaping does the trick, but I haven't tested it for dimensions
  % greater than 2.
  szrep = sz; szrep(d) = 1;
  % Apply filter along dimension d.
  fkfilt = fk.*reshape(repmat(filtk,szrep),sz);
  fs = ifft(fkfilt,[],d,'symmetric');
end

% Renormalise so that max is at same level.
maxf = f; maxfs = fs;
for d = 1:numDims
  maxf = max(maxf);
  maxfs = max(maxfs);
end
fs = fs*maxf/maxfs;
@


1.1
log
@Initial revision
@
text
@d5 1
a5 1
%   PFILT is the 'power' (flatness) of the filter (default 8).
d9 1
a9 1
% $Id$
d13 1
a13 1
  pfilt = 8;
d39 4
a42 4
  % Complicated rigmarole to replicate the filter along direction
  % d.  The problem is the singleton dimension of filtk.  I think
  % reshaping does the trick, but I haven't tested it for
  % dimensions greater than 2.
d48 8
@
