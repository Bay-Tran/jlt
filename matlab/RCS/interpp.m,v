head	1.4;
access;
symbols;
locks; strict;
comment	@// @;


1.4
date	2008.03.03.15.14.43;	author jeanluc;	state Exp;
branches;
next	1.3;

1.3
date	2008.03.02.17.17.05;	author jeanluc;	state Exp;
branches;
next	1.2;

1.2
date	2008.03.01.23.37.24;	author jeanluc;	state Exp;
branches;
next	1.1;

1.1
date	2008.02.27.05.19.39;	author jeanluc;	state Exp;
branches;
next	;


desc
@Interpolate a 1D periodic function.
@


1.4
log
@Added comment about bug.
@
text
@function fi = interpp(f,X)
%INTERPP  Interpolate a 1D periodic function.
%   FI = INTERPP(F,X) returns F(X) given the function F by
%   using linear interpolation. F is assumed period-1.
%
%   See also INTERPP2, INTERPK2.

% $Id: interpp.m,v 1.3 2008/03/02 17:17:05 jeanluc Exp $

N = length(f);

% Find which f interval X lies in.
X = N*mod(X,1);
ix1 = floor(X)+1;
ix2 = ix1+1;

% Take periodicity into account.
ix2(find(ix1 == N)) = 1;

% Special case: if X is very small and negative, then
% N*mod(X,1) gives N, rather than N*(1+X), so the floor
% function fails to round down to N-1.
%% I can't reproduce this anymore... maybe it was a bug and it's gone?
ixNp1 = find(ix1 == N+1);
ix2(ixNp1) = 1;
ix1(ixNp1) = N;

% The function at the two endpoints of the interval.
f1 = reshape(f(ix1),size(X));
f2 = reshape(f(ix2),size(X));

fi = (f2-f1).*(X-ix1) + f2;
@


1.3
log
@Vectorised!
@
text
@d8 1
a8 1
% $Id: interpp.m,v 1.2 2008/03/01 23:37:24 jeanluc Exp $
d23 1
a23 1
%find(ix == N+1)
@


1.2
log
@Changed name from interpp1 to interpp.
Gotta vectorise this!
@
text
@d8 1
a8 1
% $Id: interpp.m,v 1.1 2008/02/27 05:19:39 jeanluc Exp $
d12 1
a12 1
% Find interval.
d14 2
a15 1
ix = floor(X)+1;
d17 2
a18 16
if ix == N
  % Take periodicity into account.
  ixp = 1;
elseif ix == N+1
  % Special case: if X is very small and negative, then
  % N*mod(X,1) gives N, rather than N*(1+X), so the floor
  % function fails to round down to N-1.
  ix = N;
  ixp = 1;
else
  ixp = ix+1;
end

% The function at the four corners.
f1 = f(ix );
f2 = f(ixp);
d20 11
a30 2
X1 = X-(ix-1);
X2 = 1-X1;
d32 1
a32 1
fi = f1*X2 + f2*X1;
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
function fi = interpp1(f,X)
%INTERPP1  Interpolate a 1D periodic function.
%   FI = INTERPP2(F,X) returns F(X) given the function F by
d8 1
a8 1
% $Id$
@
